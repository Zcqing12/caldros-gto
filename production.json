{
  "meta": {
    "name": "CALDROS-GTO_V19",
    "description": "Extreme-aggressive, EV-driven, AI-adaptive fully automated quant trading system (10U→100,000U plan). Adds historical backtest, accounting, EV drift monitoring, AI learning logs, and simulation stress-testing for full lifecycle control.",
    "goal": "JSON → Auto-Build → Backtest → Deploy → Self-Optimize",
    "priority": "EV-Maximization + Compounding",
    "execution_mode": "Full-Auto",
    "ai_ready": true,
    "objectives": [
      "目标：3-6个月 10U → 100,000U",
      "爆仓率 < 5%，EV 预测误差 < 10%",
      "持仓周期动态调节（15m - 7d）",
      "跨市场信号融合（信息面 + 技术面 + 资金面 + 链上数据）"
    ],
    "notes": [
      "自动感知账户余额并动态校准仓位",
      "支持 Binance 统一账户模式，全仓 + 动态杠杆",
      "分钟级实时 Top30 热度币种信号计算",
      "EV 实时计算，胜率与收益动态贝叶斯修正"
    ]
  },

  "module_folder_structure": {
    "root": "caldros_gto",
    "folders": [
      "data_ingestion",
      "signal_engine",
      "ev_engine",
      "execution_system",
      "risk_management",
      "ai_adaptation",
      "ops_monitor",
      "ai_invocation_and_deployment",
      "tests",
      "configs",
      "deployment",
      "backtesting",
      "notebooks"
    ],
    "entry_point": "main.py"
  },

  "historical_backtest": {
    "enabled": true,
    "lookback_days": 180,
    "symbols": "dynamic_top30",
    "intervals": ["1m", "5m", "15m", "1h"],
    "rest_endpoints": {
      "klines": "https://fapi.binance.com/fapi/v1/klines",
      "trades": "https://fapi.binance.com/fapi/v1/aggTrades"
    },
    "sync_policy": {
      "max_days_per_job": 7,
      "retry": 3,
      "sleep_ms": 300
    },
    "validation_metrics": ["CAGR", "Sharpe", "MaxDD", "WinRate", "ProfitFactor"]
  },

  "accounting": {
    "pre_trade_balance_check": true,
    "margin_health_threshold": 0.15,
    "reserve_buffer_pct": 0.10,
    "max_equity_utilization_pct": 0.95,
    "margin_call_alert": "if margin_ratio < 0.12",
    "funding_cost_monitor": true
  },

  "data_ingestion": {
    "cadence_seconds": 10,
    "top_symbols_tracking": 30,
    "dynamic_selection": true,
    "selection_method": "volume + volatility + social_sentiment + funding_flip",
    "sources": [
      {
        "name": "agg_trades",
        "description": "Aggregated trade stream for real-time price & volume velocity",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@aggTrade",
        "fields": {
          "T": "trade_time",
          "p": "price",
          "q": "quantity",
          "m": "is_buyer_maker",
          "E": "event_time"
        },
        "validation": {
          "latency_ms_max": 500,
          "drop_tolerance_pct": 0.05,
          "reconnect_policy": "exponential_backoff"
        }
      },
      {
        "name": "kline",
        "description": "Multi-timeframe candle data",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@kline_{interval}",
        "intervals": ["1m", "5m", "15m", "1h", "4h", "1d"],
        "fields": {
          "t": "open_time",
          "o": "open",
          "h": "high",
          "l": "low",
          "c": "close",
          "v": "volume",
          "n": "trade_count",
          "T": "close_time"
        },
        "validation": {
          "min_candles": 200,
          "gap_tolerance_sec": 15,
          "time_sync_check": true
        }
      },
      {
        "name": "orderbook",
        "description": "Orderbook snapshot & depth delta stream",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@depth20@100ms",
        "fields": {
          "b": "bids",
          "a": "asks",
          "E": "event_time",
          "lastUpdateId": "last_update_id"
        },
        "validation": {
          "max_bid_ask_spread_pct": 0.6,
          "depth_levels_min": 20,
          "cross_check_interval_sec": 60
        }
      }
    ],
    "post_processing": {
      "aggregation": {
        "kline_merge": true,
        "multi_interval_sync": true
      },
      "feature_engineering": {
        "price_velocity": "Δprice/Δt",
        "whale_flow": "liquidation_notional_zscore",
        "order_imbalance": "(bid_volume - ask_volume) / (bid_volume + ask_volume)",
        "liquidity_pressure": "bid_ask_imbalance / total_depth",
        "trend_reversal_detector": "multi-kline reversal",
        "liquidation_heat": "notional / rolling_std"
      }
    }
  },
  "signal_engine": {
    "sources": [
      "breakout",
      "momentum",
      "sd_liquidation",
      "funding_flip",
      "orderbook_imbalance",
      "whale_flow",
      "macro_sentiment",
      "onchain_flow",
      "etf_flow",
      "social_sentiment"
    ],
    "fusion_logic": {
      "weights": {
        "breakout": 0.20,
        "momentum": 0.15,
        "sd_liquidation": 0.20,
        "funding_flip": 0.10,
        "orderbook_imbalance": 0.10,
        "whale_flow": 0.10,
        "macro_sentiment": 0.05,
        "onchain_flow": 0.05,
        "etf_flow": 0.03,
        "social_sentiment": 0.02
      },
      "activation_threshold": 0.55,
      "bayesian_update": true,
      "adaptive_weighting": true,
      "confidence_decay": {
        "enabled": true,
        "half_life_sec": 300
      },
      "consistency_factor": {
        "enabled": true,
        "threshold": 0.6,
        "boost_factor": 1.15
      }
    }
  },

  "ev_engine": {
    "formula": "EV = p * G - (1 - p) * L - fees",
    "estimation": {
      "method": "rolling_bayes + reinforcement_learning",
      "window_trades": 300,
      "beta_prior": { "alpha": 10, "beta": 6 },
      "dynamic_confidence": true
    },
    "dynamic_thresholds": {
      "enabled": true,
      "base_threshold": 0.05,
      "adjust_by_confidence": true
    },
    "ev_strategy_layers": [
      { "range": "EV ≥ 0.35", "tier": "T1_explosive", "leverage": "90x-120x" },
      { "range": "0.20 ≤ EV < 0.35", "tier": "T2_strong", "leverage": "50x-85x" },
      { "range": "0.10 ≤ EV < 0.20", "tier": "T3_moderate", "leverage": "20x-50x" },
      { "range": "0.03 ≤ EV < 0.10", "tier": "T4_neutral", "leverage": "10x-30x" },
      { "range": "-0.02 ≤ EV < 0.03", "tier": "T5_scalping", "leverage": "5x-15x" },
      { "range": "EV < -0.02", "tier": "T6_defensive", "leverage": "1x-5x" }
    ]
  },

  "execution_system": {
    "order_flow": {
      "type": "FOK/IOC",
      "slippage_tolerance_bp": 15,
      "multi_exchange_ready": true
    },
    "trade_logic": {
      "entry_conditions": {
        "T1": "EV > 0.35 and structure_valid",
        "T2": "EV > 0.20 and net_inflow_positive",
        "T3": "EV > 0.10 and signal_consistency > 0.6"
      },
      "exit_conditions": {
        "stop_loss": "structure break OR drawdown > 2σ",
        "time_stop": "signal invalid OR EV decay > 50%"
      }
    }
  },

  "risk_management": {
    "per_trade_risk_pct": 0.02,
    "daily_drawdown_limit_pct": 0.15,
    "max_open_positions": 5,
    "max_leverage_cap": 120,
    "circuit_breakers": {
      "ev_collapse": "EV < 0 for 3 consecutive signals",
      "volatility_spike": "σ > 3σ_rolling"
    }
  },

  "ai_adaptation": {
    "online_learning": {
      "enabled": true,
      "update_interval_hours": 6,
      "training_data_sources": [
        "trade_logs", "signal_outcomes", "market_regime_labels"
      ]
    },
    "learning_logs": {
      "enabled": true,
      "storage": "s3://caldros-learning-logs",
      "retention_days": 90
    }
  },

  "ops_monitor": {
    "metrics": [
      "win_rate",
      "sharpe_ratio",
      "max_drawdown",
      "EV_accuracy",
      "ev_prediction_drift"
    ],
    "critical_thresholds": {
      "win_rate": "< 0.45",
      "EV_accuracy": "< 0.60",
      "ev_prediction_drift": "> 0.15"
    }
  },

  "simulation_scenarios": {
    "enabled": true,
    "scenarios": [
      "BTC -20% crash",
      "Funding rate +100bps",
      "Volume collapse",
      "Sudden regime shift",
      "Whale flow reversal"
    ],
    "use_in_auto_tuning": true
  },

  "ai_invocation_and_deployment": {
    "entrypoints": {
      "auto_build": "/api/auto-build",
      "deploy": "/v1/deploy",
      "run_backtest": "/api/backtest"
    },
    "workflow": [
      "validate config",
      "generate modules",
      "backtest calibration",
      "stress simulation",
      "deploy and monitor"
    ]
  }
}
