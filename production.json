{
  "meta": {
    "name": "CALDROS-GTO_V18",
    "description": "Extreme-aggressive, EV-driven, AI-adaptive fully automated quant trading system. Combines real-time signal fusion, Bayesian EV estimation, dynamic Kelly sizing, information-technical synergy, and recursive self-optimization.",
    "goal": "From JSON → Auto-Build → Backtest → Live Trade with 10,000%+ target annualized return.",
    "priority": "EV-Maximization + Compounding",
    "execution_mode": "Full-Auto",
    "ai_ready": true,
    "objectives": [
      "Target: 10U → 100,000U in 3–6 months under full-compounding conditions.",
      "爆仓率 < 5%，EV 预测误差 < 10%，系统自进化周期 < 7天。",
      "持仓周期动态调节（15m - 7d），信号驱动而非时间驱动。",
      "跨市场信号融合（信息面 + 技术面 + 资金面 + 链上数据）"
    ],
    "notes": [
      "系统将自动感知账户余额并动态校准仓位",
      "支持 Binance 统一账户模式，全仓 + 动态杠杆",
      "信号实时更新（分钟级 Top30 热度币种）",
      "EV 实时计算，胜率与收益动态贝叶斯修正"
    ]
  },

  "module_folder_structure": {
    "root": "caldros_gto",
    "folders": [
      "data_ingestion",
      "signal_engine",
      "ev_engine",
      "execution_system",
      "risk_management",
      "ai_adaptation",
      "ops_monitor",
      "ai_invocation_and_deployment",
      "tests",
      "configs",
      "deployment",
      "backtesting",
      "notebooks"
    ],
    "entry_point": "main.py"
  },

  "data_ingestion": {
    "cadence_seconds": 10,
    "top_symbols_tracking": 30,
    "dynamic_selection": true,
    "selection_method": "volume + volatility + social_sentiment + funding_flip",
    "sources": [
      {
        "name": "agg_trades",
        "description": "Aggregated trade stream for real-time price & volume velocity",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@aggTrade",
        "fields": {
          "T": "trade_time",
          "p": "price",
          "q": "quantity",
          "m": "is_buyer_maker",
          "E": "event_time"
        },
        "validation": {
          "latency_ms_max": 500,
          "drop_tolerance_pct": 0.05,
          "reconnect_policy": "exponential_backoff"
        }
      },
      {
        "name": "kline",
        "description": "Multi-timeframe candle data",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@kline_{interval}",
        "intervals": ["1m", "5m", "15m", "1h", "4h", "1d"],
        "fields": {
          "t": "open_time",
          "o": "open",
          "h": "high",
          "l": "low",
          "c": "close",
          "v": "volume",
          "n": "trade_count",
          "T": "close_time"
        },
        "validation": {
          "min_candles": 200,
          "gap_tolerance_sec": 15,
          "time_sync_check": true
        }
      },
      {
        "name": "orderbook",
        "description": "Orderbook snapshot & depth delta stream",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@depth20@100ms",
        "fields": {
          "b": "bids",
          "a": "asks",
          "E": "event_time",
          "lastUpdateId": "last_update_id"
        },
        "validation": {
          "max_bid_ask_spread_pct": 0.6,
          "depth_levels_min": 20,
          "cross_check_interval_sec": 60
        }
      },
      {
        "name": "funding_rate",
        "description": "Perpetual funding rate feed",
        "type": "rest",
        "endpoint": "https://fapi.binance.com/fapi/v1/fundingRate?symbol={symbol}&limit=1",
        "fields": {
          "fundingRate": "rate",
          "fundingTime": "time"
        },
        "validation": {
          "update_interval_hr": 8,
          "rate_range": [-0.05, 0.05]
        }
      },
      {
        "name": "liquidations",
        "description": "Liquidation event feed for whale activity detection",
        "type": "websocket",
        "endpoint": "wss://fstream.binance.com/ws/{symbol}@forceOrder",
        "fields": {
          "o.s": "symbol",
          "o.S": "side",
          "o.p": "price",
          "o.q": "quantity",
          "o.X": "execution_type"
        },
        "validation": {
          "notional_min_usd": 50000,
          "zscore_spike_threshold": 2.0,
          "window_sec": 300
        }
      }
    ],
    "post_processing": {
      "aggregation": {
        "kline_merge": true,
        "multi_interval_sync": true
      },
      "feature_engineering": {
        "price_velocity": "Δprice/Δt",
        "whale_flow": "liquidation_notional_zscore",
        "order_imbalance": "(bid_volume - ask_volume) / (bid_volume + ask_volume)",
        "liquidation_heat": "notional / rolling_std",
        "trend_reversal_detector": "multi-kline structure analysis for reversals",
        "liquidity_pressure": "bid_ask_imbalance / total_depth"
      },
      "storage": {
        "raw": "parquet",
        "features": "parquet",
        "compression": "snappy",
        "retention_days": 14
      }
    }
  },
  "signal_engine": {
    "sources": [
      "breakout",
      "momentum",
      "sd_liquidation",
      "funding_flip",
      "orderbook_imbalance",
      "whale_flow",
      "macro_sentiment",
      "onchain_flow",
      "etf_flow",
      "social_sentiment"
    ],
    "fusion_logic": {
      "weights": {
        "breakout": 0.20,
        "momentum": 0.15,
        "sd_liquidation": 0.20,
        "funding_flip": 0.10,
        "orderbook_imbalance": 0.10,
        "whale_flow": 0.10,
        "macro_sentiment": 0.05,
        "onchain_flow": 0.05,
        "etf_flow": 0.03,
        "social_sentiment": 0.02
      },
      "activation_threshold": 0.55,
      "cooldown_sec": 30,
      "adaptive_weighting": true,
      "bayesian_update": true,
      "confidence_decay": {
        "enabled": true,
        "half_life_sec": 300,
        "old_signal_penalty": 0.8
      },
      "consistency_factor": {
        "enabled": true,
        "metric": "signal_agreement_ratio",
        "threshold": 0.6,
        "boost_factor": 1.15
      },
      "funding_flow_boost": {
        "enabled": true,
        "condition": "net_inflow > 1.5σ",
        "boost_factor": 1.2
      }
    },
    "multi_timeframe_support": {
      "enabled": true,
      "core_periods": ["1m", "5m", "15m", "1h"],
      "context_periods": ["4h", "1d"],
      "context_weight": 0.25,
      "cross_period_consistency": true
    },
    "feature_filters": {
      "iv_proxy": "ATR / Range",
      "liquidation_spike": "wick_ratio + price_velocity",
      "whale_flow_filter": "trade_notional_zscore > 2.5",
      "correlation_filter": "cross_pair_corr < 0.7",
      "volume_acceleration": "Δvolume / Δt > 2σ",
      "trend_reversal_structure": "multi-kline pattern reversal",
      "liquidity_squeeze": "imbalance ratio > 0.75",
      "information_surge": "macro_news_sentiment_change > 2σ"
    },
    "example_signal_flow": {
      "input_data": "kline_1m + aggTrade + funding_rate + orderbook_depth + macro_sentiment + whale_flow",
      "processing_steps": [
        "feature engineering → price velocity, whale flow, order imbalance",
        "signal scoring → breakout + momentum + funding_flip + sentiment",
        "fusion → weighted EV signal + threshold decision",
        "risk gate → volatility spike check + structural validation",
        "execution → signal classification: T1/T2/T3/T4"
      ],
      "expected_action": "EV > 0.10 and structure valid → enter Tier T2"
    }
  },

  "ev_engine": {
    "estimation": {
      "method": "rolling_bayes + reinforcement_learning",
      "window_trades": 300,
      "beta_prior": { "alpha": 10, "beta": 6 },
      "regime_adjust": true,
      "dynamic_confidence": true,
      "auto_decay": true,
      "confidence_penalty": {
        "signal_delay_penalty": 0.98,
        "volatility_spike_penalty": 0.95,
        "data_staleness_penalty": 0.9
      }
    },
    "payout_model": {
      "G": "ATR-depth adjusted + liquidity-driven multiplier",
      "L": "stop_loss + slippage + opportunity_cost",
      "slippage_bp": { "base": 4, "burst": 15 },
      "fees_bp": 1.2,
      "volatility_penalty": true,
      "black_swan_penalty": true,
      "regime_adjustment": {
        "calm": 0.9,
        "expansion": 1.0,
        "chaos": 0.7
      }
    },
    "formula": "EV = p * G - (1 - p) * L - fees",
    "dynamic_thresholds": {
      "enabled": true,
      "base_threshold": 0.05,
      "adjust_by_signal_confidence": true,
      "adjust_by_market_regime": true
    },
    "meta_signals": {
      "market_regime": "volatility regime classification (calm / expansion / chaos)",
      "risk_heat": "drawdown velocity + open interest acceleration",
      "opportunity_score": "EV_tier * volume_acceleration * structure_confidence",
      "liquidity_flow_score": "depth_pressure * bid_ask_dynamics * imbalance"
    },
    "ev_strategy_layers": [
      {
        "range": "EV ≥ 0.35",
        "tier": "T1_explosive",
        "recommended_leverage": "90x - 120x",
        "trade_frequency": "30s - 90s",
        "holding_time": "1m - 5m",
        "action": "Aggressive entry, pyramid scaling, AI override allowed",
        "ai_decision_override": true
      },
      {
        "range": "0.20 ≤ EV < 0.35",
        "tier": "T2_strong",
        "recommended_leverage": "50x - 85x",
        "trade_frequency": "1m - 5m",
        "holding_time": "3m - 15m",
        "action": "Dynamic rotation with compounding and adaptive scaling",
        "ai_decision_override": true
      },
      {
        "range": "0.10 ≤ EV < 0.20",
        "tier": "T3_moderate",
        "recommended_leverage": "20x - 50x",
        "trade_frequency": "5m - 15m",
        "holding_time": "5m - 30m",
        "action": "Moderate compounding with risk-adjusted sizing",
        "ai_decision_override": true
      },
      {
        "range": "0.03 ≤ EV < 0.10",
        "tier": "T4_neutral",
        "recommended_leverage": "10x - 30x",
        "trade_frequency": "10m - 30m",
        "holding_time": "10m - 1h",
        "action": "Neutral positioning with low exposure",
        "ai_decision_override": true
      },
      {
        "range": "-0.02 ≤ EV < 0.03",
        "tier": "T5_scalping",
        "recommended_leverage": "5x - 15x",
        "trade_frequency": "15m - 2h",
        "holding_time": "15m - 2h",
        "action": "Scalping with tight risk rails",
        "ai_decision_override": true
      },
      {
        "range": "EV < -0.02",
        "tier": "T6_defensive",
        "recommended_leverage": "1x - 5x",
        "trade_frequency": "30m - 1d",
        "holding_time": "1h - 1d",
        "action": "Defensive posture, avoid exposure",
        "ai_decision_override": true
      }
    ]
  },
  "execution_system": {
    "order_flow": {
      "type": "FOK/IOC",
      "slippage_tolerance_bp": 15,
      "post_only": false,
      "reduce_only": false,
      "multi_exchange_ready": true
    },
    "trade_logic": {
      "entry_conditions": {
        "T1": "EV > 0.35 and structure_valid and volume_accelerating and whale_flow_strong",
        "T2": "EV > 0.20 and net_inflow_positive and sentiment_supportive",
        "T3": "EV > 0.10 and signal_consistency > 0.6 and volatility_stable",
        "T4": "EV > 0.03 and volatility_acceptable",
        "T5": "EV > -0.02 and risk_heat < 0.6",
        "T6": "EV < -0.02 and volatility > 2σ → avoid"
      },
      "exit_conditions": {
        "stop_loss": "structure break OR drawdown > 2σ OR funding_flip_signal",
        "time_stop": "signal invalid OR time > 3 * avg_holding_period OR EV decay > 50%",
        "profit_take": "EV plateau OR payout ratio collapse OR reversal_detected"
      },
      "holding_logic": {
        "dynamic_exit": true,
        "max_holding_time": "24h",
        "conditional_exit": "if no profit > 0 after 15m then exit",
        "ev_replacement": "if new EV > current_position_EV → rotate to new position"
      },
      "dynamic_sizing": {
        "method": "kelly_fraction + volatility_adjusted + liquidity_scaling",
        "hedge_offset": "volatility regime dependent",
        "exposure_adjustment": "risk_heat_index * signal_confidence",
        "balance_check": "pre-trade account balance recalibration"
      },
      "pyramiding": {
        "enabled": true,
        "steps": 3,
        "add_on_rule": "EV improves + pullback < 0.5 * ATR + volume_accelerating",
        "cooldown_period_sec": 120
      }
    },
    "execution_protection": {
      "max_slippage_pct": 0.5,
      "retry_policy": "exponential_backoff",
      "grace_period_ms": 250,
      "kill_switch_conditions": [
        "EV inversion",
        "unexpected volatility surge",
        "exchange_disconnect",
        "abnormal funding_rate_flip"
      ],
      "failover_strategy": {
        "enabled": true,
        "fallback_exchange": ["OKX", "Bybit"],
        "auto_reconnect": true,
        "shadow_order_test": true
      }
    }
  },

  "risk_management": {
    "per_trade_risk_pct": 0.02,
    "daily_drawdown_limit_pct": 0.15,
    "max_open_positions": 5,
    "max_leverage_cap": 120,
    "capital_preservation_mode": {
      "enabled": true,
      "trigger_condition": "drawdown > 20% OR risk_heat > 0.9",
      "actions": [
        "reduce_leverage_by_50%",
        "pause_new_entries",
        "switch_to_T5/T6 only"
      ],
      "resume_condition": "drawdown < 10% AND EV > 0.05"
    },
    "circuit_breakers": {
      "ev_collapse": "EV < 0 for 3 consecutive signals",
      "volatility_spike": "σ > 3σ_rolling",
      "liquidation_cluster": "force orders > 5 * avg_5m",
      "funding_extremes": "funding_rate beyond ±0.08"
    },
    "stop_loss_logic": {
      "dynamic_stop": "ATR-based trailing stop + structure break validation",
      "hard_stop": "2σ below structure support OR liquidity pocket breach",
      "volatility_expansion_adjust": true,
      "market_structure_stop": true
    },
    "portfolio_hedging": {
      "enable": true,
      "hedge_assets": ["BTCUSDT", "ETHUSDT", "SOLUSDT"],
      "hedge_trigger": "risk_heat > 0.8 or correlation > 0.9",
      "inverse_scaling": "adjust hedge size inversely with EV"
    },
    "drawdown_recovery": {
      "pause_trading": "drawdown > 20%",
      "cooldown_minutes": 180,
      "resume_condition": "volatility < 1.5σ and EV > 0.05",
      "recovery_mode": "switch to T4/T5 scaling with compounding"
    },
    "stress_test": {
      "enabled": true,
      "shock_scenarios": ["-20% BTC flash crash", "+100bps funding rate spike", "volume dry-up"],
      "rebalancing_frequency_hr": 24
    }
  },
  "ai_adaptation": {
    "online_learning": {
      "enabled": true,
      "update_interval_hours": 6,
      "training_data_sources": [
        "trade_logs",
        "signal_outcomes",
        "market_regime_labels",
        "news_sentiment_stream",
        "whale_activity"
      ],
      "algorithm": "reinforcement + Bayesian optimization + meta-gradient",
      "learning_rate": 0.01,
      "confidence_weighting": "dynamic - reward shaped by EV accuracy"
    },
    "strategy_evolution": {
      "self_pruning": "drop signals with <45% win rate over 100 trades",
      "auto_weighting": "adjust weights every 100 signals based on Sharpe",
      "mutation_experiments": 5,
      "rollout_policy": "shadow_deploy → canary → production",
      "validation_pipeline": {
        "math_validation": true,
        "simulation_trades": 500,
        "auto_accept": true,
        "backtest_validation_window_days": 180
      },
      "overfit_guard": {
        "rolling_validation_loss": "must remain below 0.25",
        "sim_vs_live_correlation": "must remain > 0.75"
      }
    },
    "meta_learning": {
      "global_signals": [
        "macro_volatility",
        "liquidity_index",
        "onchain_whale_flow",
        "ETF_inflows",
        "market_regime_shifts",
        "stablecoin_supply_trend"
      ],
      "adaptive_thresholds": true,
      "context_aware_risk": "regime-conditioned Kelly sizing + liquidity scaling",
      "confidence_decay": "apply time-decay to signals older than 2h"
    },
    "risk_recalibration_ai": {
      "enabled": true,
      "bayesian_update_interval_sec": 30,
      "adaptive_stoploss_tuning": "based on realized volatility clusters",
      "exposure_recalibration": "adjust Kelly fraction based on 30d rolling drawdown"
    }
  },

  "ops_monitor": {
    "metrics": [
      "win_rate",
      "sharpe_ratio",
      "max_drawdown",
      "average_slippage",
      "order_fill_latency",
      "signal_latency",
      "volatility_regime",
      "risk_heat_index",
      "EV_accuracy",
      "alpha_decay_rate"
    ],
    "alerting": {
      "channels": ["slack", "webhook", "grafana"],
      "critical_thresholds": {
        "win_rate": "< 0.45",
        "drawdown": "> 25%",
        "latency_ms": "> 1000",
        "signal_failure_rate": "> 0.05",
        "EV_accuracy": "< 0.60"
      },
      "cooldown_sec": 300
    },
    "self_healing": {
      "restart_conditions": [
        "signal engine crash",
        "execution timeout",
        "exchange connection drop",
        "EV drift > 25%"
      ],
      "auto_restart": true,
      "backup_redeploy": "fallback Docker image if repeated failure > 3",
      "auto_config_patch": "retrain or reoptimize modules with degraded metrics"
    },
    "reporting": {
      "daily_summary": "PnL, Sharpe, EV accuracy, risk metrics",
      "weekly_review": "signal performance attribution + meta-learning report",
      "real_time_dashboard": "Grafana + Slack feed"
    }
  },

  "ai_invocation_and_deployment": {
    "entrypoints": {
      "auto_build": "/api/auto-build",
      "deploy": "/v1/deploy",
      "generate_module": "/generate/{module}",
      "run_backtest": "/api/backtest",
      "simulate": "/api/simulate"
    },
    "workflow": [
      "validate production.json",
      "generate project structure",
      "auto-code generation",
      "test & self-repair",
      "backtest calibration",
      "docker build",
      "cloud deploy",
      "live EV recalibration loop"
    ],
    "cloud_environment": {
      "provider": "Zeabur",
      "container": "python:3.11-slim",
      "autoscaling": {
        "enabled": true,
        "min_instances": 1,
        "max_instances": 10,
        "scale_metric": "signal_rate + volume_flow"
      },
      "env_vars": [
        "OPENAI_API_KEY",
        "BINANCE_API_KEY",
        "BINANCE_API_SECRET",
        "SLACK_WEBHOOK",
        "GRAFANA_API_KEY"
      ]
    },
    "post_deployment_hooks": {
      "backtest_validation": true,
      "live_sanity_check": true,
      "slack_notify": true,
      "auto_signal_benchmark": true
    },
    "safety_checks": {
      "config_integrity": "hash verification",
      "model_version": ">= gpt-5",
      "kill_switch": "if EV < -0.1 for 5 consecutive trades",
      "overfit_guard": "disable signals with live win rate < 0.4"
    },
    "multi_exchange_ready": {
      "enabled": true,
      "supported": ["Binance", "OKX", "Bybit"],
      "routing_logic": "latency + fee + liquidity based dynamic routing",
      "failover": "auto switch if >3 failed orders in 60s"
    }
  }
}
